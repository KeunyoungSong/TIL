# 입력 차원(D), 샘플 수(N), 배치 크기(B) 구분하기

> Type: Concept

## 상황/배경(Context)
“입력 차원 100”이라는 표현을 들었을 때, “샘플이 100개”라는 뜻으로 착각하기 쉽다. 옵티마이저/GD 시각화 같은 주제를 이해하려면 `입력 차원`, `샘플 수`, `배치 크기`를 먼저 분리해서 잡아야 한다.

---

## 정의(Definition)
- **샘플 수(N)**: 데이터가 몇 개 있는지(행 개수)
- **입력 차원(D)**: 샘플 1개가 가진 특성(feature) 개수(열 개수)
- **배치 크기(B)**: 한 번의 forward/backward에서 처리하는 샘플 수

즉, “입력 차원 100”은 **샘플 하나가 100개의 값(특성)을 가진다**는 뜻이지, “샘플이 100개 있다”는 뜻이 아니다.

## 핵심 아이디어(Key Ideas)
- `N`, `D`, `B`는 서로 다른 축이다.
- 보통 탭 데이터/MLP에서는 데이터 행렬이 `(N, D)`로 표현된다.
- 배치 학습에서는 그중 일부 행만 잘라 `(B, D)`를 네트워크에 넣는다.
- “입력 차원”은 데이터의 모양(shape)이고, “파라미터 수”와는 별개 개념이다.

## 기호 정리(Symbols)
- `N`: 샘플 수(데이터 개수)
- `D`: 입력 차원(특성 수)
- `B`: 배치 크기
- `X`: 입력 데이터 행렬/텐서
- `x_i`: i번째 샘플(벡터)

## 원리/수식(Principle/Math)
탭 데이터/MLP 기준으로 입력 데이터는 보통 다음 형태로 생각한다.

$$
X \in \mathbb{R}^{N \times D}
$$

의미:
- 행(row) 방향: 샘플 `N`개
- 열(column) 방향: 특성 `D`개

배치 학습에서는 미니배치 `X_batch`를 다음처럼 뽑아서 사용한다.

$$
X_{\text{batch}} \in \mathbb{R}^{B \times D}
$$

프레임워크 관점(PyTorch/TensorFlow)에서 흔히 보는 shape도 동일하게 `(batch_size, input_dim)`이다.

## 예시(Examples)
### 예시 1) “입력 차원 100”이 의미하는 것
입력 차원 `D=100`이면 한 샘플은 다음처럼 길이 100의 벡터다.

$$
x_i = [x_{i1}, x_{i2}, \ldots, x_{i100}]
$$

여기서 `x_i`는 **샘플 1개**다(샘플 개수랑 무관).

### 예시 2) N, D, B를 숫자로 같이 두면 바로 구분된다
예시 상황:
- 총 샘플 수: `N=10,000`
- 입력 차원: `D=100`
- 배치 크기: `B=32`

그러면:

$$
X \in \mathbb{R}^{10000 \times 100}, \quad
X_{\text{batch}} \in \mathbb{R}^{32 \times 100}
$$

즉, “샘플이 100개”는 `N=100`인 경우에만 맞는 말이고, “입력 차원 100”은 `D=100`을 뜻한다.

### 예시 3) CNN/Transformer에서는 “입력 노드 수” 표현이 어색해질 수 있다
- CNN 입력: 예를 들어 이미지가 `(H, W, C)` 텐서(또는 `(C, H, W)`) 형태다. 입력 차원은 “값의 개수”로는 `H×W×C`이지만, 보통은 “노드 D개”로 말하지 않고 **텐서 shape**로 말한다.
- Transformer 입력: `(sequence_length, embedding_dim)` 같은 텐서로 들어가며, 이것도 “입력 노드 수”라기보다 **시퀀스×임베딩 shape**로 다룬다.

## 주의할 점(Caveats)
- “입력 차원”을 MLP에서는 입력 노드 수로 생각해도 되지만, CNN/Transformer처럼 텐서 입력이 일반적인 모델에서는 “노드 수” 표현이 오해를 만든다.
- `입력 차원(D)`과 `파라미터 수(#θ)`는 다른 개념이다. 예를 들어 첫 Dense layer가 `D → H`면 그 layer의 가중치만 `D×H`개가 될 수 있지만, 이건 “입력 차원” 자체가 아니라 “모델 구조/레이어 크기”가 결정한다.

## 한 줄 요약(Summary)
입력 차원 `D`는 “샘플 1개가 가진 특성 수”, 샘플 수 `N`은 “데이터 개수”, 배치 크기 `B`는 “한 번에 처리하는 샘플 수”이며, 보통 데이터 shape는 `(N, D)`, 배치는 `(B, D)`로 구분한다.

## 용어(Glossary)
- **sample**: 데이터 한 개(관측치 1개)
- **feature**: 샘플을 구성하는 입력 요소(특성)
- **batch**: 학습 단계에서 한 번에 처리하는 샘플 묶음
